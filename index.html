<script>
        const BIN_URL = 'https://api.npoint.io/50a3a47c4e1b58827a76';

        async function updateKira() {
            try {
                // Forzamos la petición con modo 'cors' y quitamos el cache
                const response = await fetch(BIN_URL, {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'no-cache',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) throw new Error("Error de Red");
                
                const data = await response.json();

                if (data && data.precio) {
                    // 1. ACTUALIZAR PRECIO
                    const precio = document.getElementById('price-display');
                    precio.innerText = data.precio;
                    precio.style.color = "#fff"; // Asegurar que sea blanco

                    // 2. ACTUALIZAR ESTADO
                    document.getElementById('last-ts').innerText = "ÚLTIMO PULSO: " + (data.last_update || "Recibiendo...");
                    
                    // 3. NEURAL LINK A VERDE
                    const status = document.getElementById('connection-status');
                    status.style.background = "#10b981";
                    status.style.boxShadow = "0 0 15px #10b981";

                    // 4. ACTUALIZAR SEÑAL
                    const sigCont = document.getElementById('signals-container');
                    if (data.fvg && data.fvg.includes("DETECTADO")) {
                        sigCont.innerHTML = `<div style="color: #10b981; font-weight: bold; border-left: 2px solid #10b981; padding-left: 10px;">${data.fvg}</div>`;
                    } else {
                        sigCont.innerHTML = "<span style='color: #4b5563;'>Sincronizado. Buscando FVG...</span>";
                    }
                }
            } catch (err) {
                console.error("Error de enlace:", err);
                // Si falla, vuelve a rojo
                const status = document.getElementById('connection-status');
                status.style.background = "red";
                status.style.boxShadow = "none";
            }
        }

        // Ejecutar inmediatamente y luego cada 3 segundos
        updateKira();
        setInterval(updateKira, 3000);
</script>
